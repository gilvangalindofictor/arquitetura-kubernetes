# Tempo values configuration
# Deploys Tempo for distributed tracing

# Use the simple scalable deployment mode
distributor:
  replicas: 2

ingester:
  replicas: 2
  persistence:
    enabled: true
    size: 20Gi
    storageClassName: "gp2"

compactor:
  replicas: 1
  persistence:
    enabled: true
    size: 20Gi
    storageClassName: "gp2"

storage:
  trace:
    backend: s3
    s3:
      # Replace with the actual bucket name from Terraform output
      bucket: "observability-traces-ACCOUNT_ID"
      endpoint: "s3.us-east-1.amazonaws.com"

# Use IRSA to grant S3 permissions
serviceAccount:
  create: true
  name: "tempo"
  annotations:
    # Replace ACCOUNT_ID with your actual AWS account ID
    # The role name should match the one created by the IAM Terraform module
    eks.amazonaws.com/role-arn: "arn:aws:iam::ACCOUNT_ID:role/observability-observability-prd-sa-role"

# Expose the query frontend for Grafana
query_frontend:
  service:
    type: ClusterIP
